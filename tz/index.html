<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ç‰©æ–™æŸ¥è¯¢ç³»ç»Ÿ</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col items-center p-6">
  <h1 class="text-3xl font-bold text-gray-800 mb-6">ç‰©æ–™æŸ¥è¯¢ç³»ç»Ÿ</h1>

  <!-- æŸ¥è¯¢è¾“å…¥åŒº -->
  <div class="w-full max-w-4xl bg-white p-6 rounded-2xl shadow mb-8">
    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
      <input id="supplier" type="text" placeholder="ä¾›åº”å•†åç§°" class="border p-2 rounded w-full" />
      <input id="projectId" type="text" placeholder="é¡¹ç›®å·" class="border p-2 rounded w-full" />
      <input id="projectName" type="text" placeholder="é¡¹ç›®åç§°" class="border p-2 rounded w-full" />
      <button id="searchBtn" class="bg-blue-600 text-white rounded p-2 hover:bg-blue-700">æŸ¥è¯¢</button>
    </div>
  </div>

  <!-- æŸ¥è¯¢ç»“æœè¡¨æ ¼ -->
  <div class="w-full max-w-6xl bg-white p-6 rounded-2xl shadow">
    <table class="min-w-full border border-gray-300 text-sm text-gray-700">
      <thead class="bg-gray-100">
        <tr>
          <th class="border px-3 py-2">åˆåŒç¼–å·</th>
          <th class="border px-3 py-2">ä¾›åº”å•†åç§°</th>
          <th class="border px-3 py-2">é¡¹ç›®å·</th>
          <th class="border px-3 py-2">é¡¹ç›®åç§°</th>
          <th class="border px-3 py-2">æ•°é‡</th>
          <th class="border px-3 py-2">å•ä½</th>
          <th class="border px-3 py-2">é‡‡è´­å•ä»·</th>
          <th class="border px-3 py-2">è®¢å•æ€»é¢</th>
        </tr>
      </thead>
      <tbody id="resultTable">
        <tr><td colspan="8" class="text-center text-gray-400 py-4">è¯·è¾“å…¥æŸ¥è¯¢æ¡ä»¶åç‚¹å‡»æŸ¥è¯¢</td></tr>
      </tbody>
    </table>

    <!-- é‡‘é¢æ€»è®¡ -->
    <div id="totalAmount" class="text-right text-lg font-semibold text-gray-800 mt-4"></div>
  </div>

  <!-- é¡µè„š -->
  <footer class="mt-10 text-gray-500 text-sm">
    Â© 2025 ç”±ç‹ç»´è®¾è®¡
  </footer>

  <script>
    // å…¨å±€å˜é‡ï¼Œç”¨äºå­˜å‚¨æ•°æ®
    let allData = [];

    // é¡µé¢åŠ è½½æ—¶å°è¯•åŠ è½½æ•°æ®
    document.addEventListener('DOMContentLoaded', async function() {
      await loadData();
    });

    async function loadData() {
      try {
        // ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œä»å½“å‰ç›®å½•çš„data.jsonåŠ è½½
        const response = await fetch('data.json');
        
        if (!response.ok) {
          throw new Error(`HTTPé”™è¯¯! çŠ¶æ€: ${response.status}`);
        }
        
        allData = await response.json();
        console.log("âœ… æˆåŠŸè¯»å– JSON æ•°æ®ï¼Œå…±", allData.length, "æ¡è®°å½•");
      } catch (err) {
        console.error("âŒ åŠ è½½ data.json å¤±è´¥ï¼š", err);
        
        // å¦‚æœåŠ è½½å¤±è´¥ï¼Œä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®
        allData = [
          {"åˆåŒç¼–å·":"SC2022-1-4-04","ä¾›åº”å•†åç§°":"å››å·é¼æ™Ÿå¡‘æ–™åˆ¶å“æœ‰é™å…¬å¸","é¡¹ç›®å·":"81003852","é¡¹ç›®åç§°":"é›ªèŠç“¶èº«","æ•°é‡":"7000","å•ä½":"ä¸ª","é‡‡è´­å•ä»·":"1.21","è®¢å•æ€»é¢":"8470"},
          {"åˆåŒç¼–å·":"SC2022-1-4-04","ä¾›åº”å•†åç§°":"å››å·é¼æ™Ÿå¡‘æ–™åˆ¶å“æœ‰é™å…¬å¸","é¡¹ç›®å·":"81003853","é¡¹ç›®åç§°":"é›ªèŠç“¶ç›–","æ•°é‡":"7000","å•ä½":"ä¸ª","é‡‡è´­å•ä»·":"0.33","è®¢å•æ€»é¢":"2310"},
          {"åˆåŒç¼–å·":"SC2022-1-4-03","ä¾›åº”å•†åç§°":"ä¸œèé“­ä¸°åŒ…è£…è‚¡ä»½æœ‰é™å…¬å¸","é¡¹ç›®å·":"81009751","é¡¹ç›®åç§°":"12ç½å°ç½èŒ¶äºšå…‹åŠ›ç›’","æ•°é‡":"5000","å•ä½":"å¥—","é‡‡è´­å•ä»·":"30.67","è®¢å•æ€»é¢":"153350"},
          {"åˆåŒç¼–å·":"SC2022-1-4-05","ä¾›åº”å•†åç§°":"æ¸©å·å¸‚ç‘æ¬£å°åŠ¡åŒ…è£…æœ‰é™å…¬å¸","é¡¹ç›®å·":"81010491","é¡¹ç›®åç§°":"å®½47cmçƒ­æ”¶ç¼©è†œ","æ•°é‡":"300","å•ä½":"å…¬æ–¤","é‡‡è´­å•ä»·":"21","è®¢å•æ€»é¢":"6300"},
          {"åˆåŒç¼–å·":"SC2022-1-4-02","ä¾›åº”å•†åç§°":"æ­é˜³å¸‚æ’é¡ºæ³°é‡‘å±åˆ¶å“æœ‰é™å…¬å¸","é¡¹ç›®å·":"81003989","é¡¹ç›®åç§°":"å‹ºå­","æ•°é‡":"10000","å•ä½":"æ”¯","é‡‡è´­å•ä»·":"2.62","è®¢å•æ€»é¢":"26200"}
        ];
        
        console.log("âš ï¸ ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ï¼Œå…±", allData.length, "æ¡è®°å½•");
      }
    }

    function searchData() {
      const supplier = document.getElementById('supplier').value.trim();
      const projectId = document.getElementById('projectId').value.trim();
      const projectName = document.getElementById('projectName').value.trim();

      console.log("ğŸ” æœç´¢æ¡ä»¶ï¼š", { supplier, projectId, projectName });

      const resultTable = document.getElementById('resultTable');
      const totalAmountEl = document.getElementById('totalAmount');

      // å¦‚æœæ²¡æœ‰è¾“å…¥ä»»ä½•æ¡ä»¶ï¼Œæ˜¾ç¤ºæç¤ºä¿¡æ¯
      if (!supplier && !projectId && !projectName) {
        resultTable.innerHTML = `<tr><td colspan="8" class="text-center text-gray-400 py-4">è¯·è¾“å…¥æŸ¥è¯¢æ¡ä»¶åç‚¹å‡»æŸ¥è¯¢</td></tr>`;
        totalAmountEl.textContent = "";
        return;
      }

      const filtered = allData.filter(item => {
        const supplierMatch = !supplier || item.ä¾›åº”å•†åç§°.includes(supplier);
        const projectIdMatch = !projectId || item.é¡¹ç›®å·.includes(projectId);
        const projectNameMatch = !projectName || item.é¡¹ç›®åç§°.includes(projectName);
        return supplierMatch && projectIdMatch && projectNameMatch;
      });

      resultTable.innerHTML = "";
      totalAmountEl.textContent = "";

      if (filtered.length === 0) {
        resultTable.innerHTML = `<tr><td colspan="8" class="text-center text-gray-400 py-4">æœªæ‰¾åˆ°åŒ¹é…çš„è®°å½•</td></tr>`;
        return;
      }

      let total = 0;
      filtered.forEach(row => {
        total += parseFloat(row.è®¢å•æ€»é¢);
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td class="border px-3 py-2">${row.åˆåŒç¼–å·}</td>
          <td class="border px-3 py-2">${row.ä¾›åº”å•†åç§°}</td>
          <td class="border px-3 py-2">${row.é¡¹ç›®å·}</td>
          <td class="border px-3 py-2">${row.é¡¹ç›®åç§°}</td>
          <td class="border px-3 py-2 text-right">${parseInt(row.æ•°é‡).toLocaleString()}</td>
          <td class="border px-3 py-2">${row.å•ä½}</td>
          <td class="border px-3 py-2 text-right">${parseFloat(row.é‡‡è´­å•ä»·).toLocaleString()}</td>
          <td class="border px-3 py-2 text-right">${parseFloat(row.è®¢å•æ€»é¢).toLocaleString()}</td>
        `;
        resultTable.appendChild(tr);
      });

      totalAmountEl.textContent = "ğŸ’° é‡‘é¢æ€»è®¡ï¼š" + total.toLocaleString() + " å…ƒ";
    }

    // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
    document.getElementById('searchBtn').addEventListener('click', searchData);
    
    // ä¸ºè¾“å…¥æ¡†æ·»åŠ å›è½¦é”®æ”¯æŒ
    document.getElementById('supplier').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') searchData();
    });
    document.getElementById('projectId').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') searchData();
    });
    document.getElementById('projectName').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') searchData();
    });
  </script>
</body>
</html>
